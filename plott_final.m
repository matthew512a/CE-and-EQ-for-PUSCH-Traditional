% Dữ liệu SNR
snr = 0:2:30;

% ================= BER =================
% BER - QPSK
ber_qpsk_ls = [0.232377, 0.180719, 0.133488, 0.093780, 0.063212, 0.041561, 0.027384, 0.018446, 0.012561, 0.008580, 0.005802, 0.003906, 0.002679, 0.001874, 0.001354, 0.001025];
ber_qpsk_mmse = [0.189151, 0.144662, 0.105078, 0.072554, 0.048268, 0.031632, 0.020957, 0.014222, 0.009766, 0.006669, 0.004536, 0.003094, 0.002161, 0.001554, 0.001159, 0.000910];

% BER - 16QAM
ber_16qam_ls = [0.332519, 0.289872, 0.245368, 0.200672, 0.158089, 0.119696, 0.086668, 0.060282, 0.040527, 0.026916, 0.018068, 0.012456, 0.008775, 0.006336, 0.004659, 0.003576];
ber_16qam_mmse = [0.342624, 0.295042, 0.244019, 0.194430, 0.149310, 0.110097, 0.077760, 0.052906, 0.035124, 0.023294, 0.015801, 0.011012, 0.007822, 0.005669, 0.004214, 0.003277];

% BER - 64QAM
ber_64qam_ls = [0.387630, 0.356179, 0.321263, 0.283671, 0.244650, 0.205537, 0.167809, 0.132676, 0.101361, 0.074718, 0.053314, 0.037118, 0.025752, 0.018192, 0.013409, 0.010329];
ber_64qam_mmse = [0.399237, 0.362557, 0.320501, 0.277064, 0.234194, 0.192935, 0.154513, 0.119719, 0.089589, 0.064746, 0.045424, 0.031385, 0.021836, 0.015665, 0.011766, 0.009245];

% Vẽ BER
figure;
semilogy(snr, ber_qpsk_ls, 'g^-', 'Color', [0 0.6 0] , 'LineWidth', 1.2); hold on;
semilogy(snr, ber_qpsk_mmse, 'gs-', 'Color', [0 0.6 0], 'LineWidth', 1.2);
semilogy(snr, ber_16qam_ls, 'b^-', 'Color', [0 0.4 1], 'LineWidth', 1.2);
semilogy(snr, ber_16qam_mmse, 'bs-', 'Color', [0 0.4 1], 'LineWidth', 1.2);
semilogy(snr, ber_64qam_ls, 'r^-', 'Color', [1 0 0], 'LineWidth', 1.2);
semilogy(snr, ber_64qam_mmse, 'rs-', 'Color', [1 0 0], 'LineWidth', 1.2);
xlabel('SNR (dB)'); ylabel('BER'); grid on;
legend('QPSK - LS/ZF', 'QPSK - MMSE', ...
       '16QAM - LS/ZF', '16QAM - MMSE', ...
       '64QAM - LS/ZF', '64QAM - MMSE');
title('BER vs. SNR');

% ================= MSE =================
% MSE - QPSK
mse_qpsk_ls = [11.27928, 6.64001, 4.43452, 4.57825, 2.52938, 1.46979, 0.91804, 0.77247, 0.37957, 0.27998, 0.15094, 0.10432, 0.07053, 0.04194, 0.02895, 0.13792];
mse_qpsk_mmse = [0.60896, 0.49030, 0.38556, 0.29761, 0.22607, 0.16937, 0.12542, 0.09203, 0.06710, 0.04875, 0.03550, 0.02602, 0.01938, 0.01480, 0.01169, 0.00963];

% MSE - 16QAM
mse_16qam_ls = [10.10392, 6.79539, 4.92913, 4.42824, 2.68623, 1.19682, 2.88554, 0.65447, 0.75206, 0.43777, 0.18289, 0.09235, 0.05999, 0.03989, 0.02654, 0.01751];
mse_16qam_mmse = [0.60905, 0.49019, 0.38564, 0.29757, 0.22604, 0.16935, 0.12537, 0.09204, 0.06710, 0.04873, 0.03550, 0.02601, 0.01937, 0.01479, 0.01169, 0.00963];

% MSE - 64QAM
mse_64qam_ls = [11.51611, 7.37180, 4.25665, 3.21317, 1.84959, 1.54507, 1.02719, 0.70389, 0.40028, 0.21715, 0.16471, 0.13611, 0.06525, 0.03636, 0.02711, 0.02779];
mse_64qam_mmse = [0.60905, 0.49026, 0.38539, 0.29769, 0.22617, 0.16935, 0.12547, 0.09202, 0.06708, 0.04877, 0.03547, 0.02603, 0.01937, 0.01478, 0.01168, 0.00963];

% Vẽ MSE
figure;
semilogy(snr, mse_qpsk_ls, 'g^-', 'Color', [0 0.6 0] , 'LineWidth', 1.2); hold on;
semilogy(snr, mse_qpsk_mmse, 'gs-', 'Color', [0 0.6 0], 'LineWidth', 1.2);
semilogy(snr, mse_16qam_ls, 'b^-', 'Color', [0 0.4 1], 'LineWidth', 1.2);
semilogy(snr, mse_16qam_mmse, 'bs-', 'Color', [0 0.4 1], 'LineWidth', 1.2);
semilogy(snr, mse_64qam_ls, 'r^-', 'Color', [1 0 0], 'LineWidth', 1.2);
semilogy(snr, mse_64qam_mmse, 'rs-', 'Color', [1 0 0], 'LineWidth', 1.2);
xlabel('SNR (dB)'); ylabel('MSE'); grid on;
legend('QPSK - LS/ZF', 'QPSK - MMSE', ...
       '16QAM - LS/ZF', '16QAM - MMSE', ...
       '64QAM - LS/ZF', '64QAM - MMSE');
title('MSE vs. SNR');
