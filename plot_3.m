SNR = 0:2:30;

%% --- Dữ liệu QPSK ---
BER_LS_QPSK = [0.241582 0.193482 0.145745 0.103186 0.074810 0.049662 0.034094 0.023223 0.018796 0.013208 0.011318 0.009369 0.008970 0.007725 0.007678 0.007115];
BER_MMSE_QPSK = [0.193787 0.151533 0.114187 0.080680 0.056753 0.038227 0.027214 0.019160 0.014194 0.011470 0.009827 0.008500 0.008265 0.007584 0.007126 0.007115];

MSE_LS_QPSK = [5.81588 3.53960 7.41771 1.36489 1.53294 0.84074 0.69606 0.69668 0.36810 0.30114 0.19291 0.30462 0.32969 8.12382 0.17253 0.27264];
MSE_MMSE_QPSK = [0.61748 0.50163 0.40066 0.31423 0.24827 0.18843 0.14794 0.11598 0.09299 0.07856 0.06890 0.06481 0.06542 0.06475 0.06977 0.06890];

%% --- Dữ liệu 16QAM ---
BER_LS_16QAM = [0.338963 0.297478 0.258835 0.210899 0.169578 0.132854 0.104079 0.077539 0.057328 0.043486 0.036313 0.029785 0.026310 0.023880 0.022183 0.021144];
BER_MMSE_16QAM = [0.344111 0.300495 0.250775 0.201542 0.158437 0.121754 0.091839 0.068887 0.051664 0.039542 0.033196 0.027731 0.025042 0.022765 0.021591 0.020833];

MSE_LS_16QAM = [5.64722 4.86177 3.46198 2.29229 0.76617 1.21974 0.70658 0.44178 0.47645 4.20910 0.22676 0.47056 0.15555 0.31295 0.16584 0.20206];
MSE_MMSE_16QAM = [0.61654 0.50579 0.40020 0.31444 0.24330 0.18928 0.14669 0.11687 0.09415 0.07740 0.07024 0.06550 0.06611 0.06587 0.06821 0.07677];

%% --- Dữ liệu 64QAM ---
BER_LS_64QAM = [0.391902 0.362266 0.326892 0.292692 0.256042 0.219866 0.182442 0.152159 0.125474 0.102149 0.084312 0.070626 0.061704 0.055603 0.051486 0.049224];
BER_MMSE_64QAM = [0.400038 0.365150 0.325162 0.282638 0.243355 0.205480 0.169261 0.138345 0.113400 0.092522 0.076935 0.065449 0.057395 0.053407 0.050002 0.048257];

MSE_LS_64QAM = [6.23176 4.73451 7.17369 2.66964 4.55372 1.79826 0.65909 1.14631 0.47055 0.20322 0.20296 0.17040 0.23558 0.14485 0.22750 0.12976];
MSE_MMSE_64QAM = [0.61339 0.50028 0.40169 0.31498 0.24516 0.19157 0.14739 0.11549 0.09511 0.07859 0.06881 0.06618 0.06051 0.06470 0.06838 0.07681];

%% --- Vẽ đồ thị ---
figure;

% === Biểu đồ BER ===
%subplot(2,1,1); % tạo biểu đồ phụ đầu tiên
% QPSK - màu xanh lá cây
semilogy(SNR, BER_LS_QPSK, '-o', 'Color', [0 0.6 0], 'LineWidth', 1.2); hold on;
semilogy(SNR, BER_MMSE_QPSK, '-s', 'Color', [0 0.6 0], 'LineWidth', 1.2);

% 16QAM - màu xanh biển
semilogy(SNR, BER_LS_16QAM, '-o', 'Color', [0 0.4 1], 'LineWidth', 1.2);
semilogy(SNR, BER_MMSE_16QAM, '-s', 'Color', [0 0.4 1], 'LineWidth', 1.2);

% 64QAM - màu đỏ
semilogy(SNR, BER_LS_64QAM, '-o', 'Color', [1 0 0], 'LineWidth', 1.2);
semilogy(SNR, BER_MMSE_64QAM, '-s', 'Color', [1 0 0], 'LineWidth', 1.2);

grid on;
xlabel('SNR (dB)');
ylabel('BER');
title('Bit Error Rate vs SNR');
legend('QPSK - LS/ZF', 'QPSK - MMSE', ...
       '16QAM - LS/ZF', '16QAM - MMSE', ...
       '64QAM - LS/ZF', '64QAM - MMSE');

% === Biểu đồ MSE ===
figure;
%subplot(2,1,2); % tạo biểu đồ phụ thứ hai
% QPSK - màu xanh lá cây
plot(SNR, MSE_LS_QPSK, '-o', 'Color', [0 0.6 0], 'LineWidth', 1.2); hold on;
plot(SNR, MSE_MMSE_QPSK, '-*', 'Color', [0 0.6 0], 'LineWidth', 1.2);

% 16QAM - màu xanh biển
plot(SNR, MSE_LS_16QAM, '-o', 'Color', [0 0.4 1], 'LineWidth', 1.2);
plot(SNR, MSE_MMSE_16QAM, '-*', 'Color', [0 0.4 1], 'LineWidth', 1.2);

% 64QAM - màu đỏ
plot(SNR, MSE_LS_64QAM, '-o', 'Color', [1 0 0], 'LineWidth', 1.2);
plot(SNR, MSE_MMSE_64QAM, '-*', 'Color', [1 0 0], 'LineWidth', 1.2);

grid on;
xlabel('SNR (dB)');
ylabel('MSE');
title('Mean Square Error vs SNR');
legend('QPSK - LS/ZF', 'QPSK - MMSE', ...
       '16QAM - LS/ZF', '16QAM - MMSE', ...
       '64QAM - LS/ZF', '64QAM - MMSE');

