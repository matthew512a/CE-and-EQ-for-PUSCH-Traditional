% Dữ liệu SNR
snr = 0:2:30;

% BER - QPSK
ber_qpsk_ls = [0.232605,0.179907,0.133326,0.092982,0.063312,0.041905,0.027255,0.018456,0.012479,0.008421,0.005990,0.003946,0.002651,0.001883,0.001443,0.001020];
ber_qpsk_mmse = [0.188928,0.144169,0.104845,0.072692,0.048095,0.031716,0.021035,0.014139,0.009651,0.006670,0.004586,0.003020,0.002085,0.001524,0.001179,0.000913];

% BER - 16QAM
ber_16qam_ls = [0.332065,0.291192,0.245254,0.201168,0.158452,0.119561,0.086836,0.060518,0.040182,0.026847,0.018029,0.012285,0.008779,0.006335,0.004678,0.003522];
ber_16qam_mmse = [0.342240,0.295223,0.243779,0.195031,0.149469,0.110254,0.077899,0.052939,0.034946,0.023267,0.015882,0.010992,0.007820,0.005710,0.004205,0.003265];

% BER - 64QAM
ber_64qam_ls = [0.387440,0.356841,0.321613,0.283404,0.244254,0.206467,0.167948,0.132894,0.101213,0.074676,0.053485,0.037171,0.025681,0.018175,0.013384,0.010367];
ber_64qam_mmse = [0.399157,0.362413,0.320311,0.276964,0.234071,0.193139,0.154770,0.119683,0.089476,0.064737,0.045696,0.031501,0.021752,0.015608,0.011693,0.009281];

% Vẽ BER
figure;
semilogy(snr, ber_qpsk_ls, 'g^-', 'Color', [0 0.6 0] , 'LineWidth', 1.2); hold on;
semilogy(snr, ber_qpsk_mmse, 'gs-', 'Color', [0 0.6 0], 'LineWidth', 1.2);
semilogy(snr, ber_16qam_ls, 'b^-', 'Color', [0 0.4 1], 'LineWidth', 1.2);
semilogy(snr, ber_16qam_mmse, 'bs-', 'Color', [0 0.4 1], 'LineWidth', 1.2);
semilogy(snr, ber_64qam_ls, 'r^-', 'Color', [1 0 0], 'LineWidth', 1.2);
semilogy(snr, ber_64qam_mmse, 'rs-', 'Color', [1 0 0], 'LineWidth', 1.2);
xlabel('SNR (dB)'); ylabel('BER'); grid on;
legend('QPSK - LS/ZF', 'QPSK - MMSE', ...
       '16QAM - LS/ZF', '16QAM - MMSE', ...
       '64QAM - LS/ZF', '64QAM - MMSE');
title('BER vs. SNR');

% MSE - QPSK
mse_qpsk_ls = [8.31156,5.34830,6.44256,1.74342,2.04199,1.34028,0.59397,0.47194,0.35015,0.22782,0.11038,0.06655,0.04207,0.04189,0.05537,0.01931];
mse_qpsk_mmse = [0.60926,0.49006,0.38507,0.29762,0.22578,0.16984,0.12563,0.09193,0.06705,0.04875,0.03563,0.02602,0.01924,0.01461,0.01180,0.00962];

% MSE - 16QAM
mse_16qam_ls = [12.2825,6.33962,4.49532,1.85563,1.64024,1.49651,0.70906,0.41602,0.21854,0.15915,0.12422,0.05765,0.04367,0.02840,0.02804,0.01744];
mse_16qam_mmse = [0.60897,0.48973,0.38584,0.29781,0.22588,0.16923,0.12542,0.09196,0.06697,0.04879,0.03550,0.02600,0.01929,0.01486,0.01171,0.00960];

% MSE - 64QAM
mse_64qam_ls = [16.35761,5.88916,3.64316,2.28864,1.27695,1.33059,0.70237,0.40260,0.39693,0.30981,0.22932,0.08496,0.61600,0.03035,0.02050,0.01511];
mse_64qam_mmse = [0.60869,0.49096,0.38569,0.29714,0.22638,0.16956,0.12586,0.09236,0.06673,0.04861,0.03563,0.02624,0.01928,0.01476,0.01173,0.00956];

% Vẽ MSE
figure;
semilogy(snr, mse_qpsk_ls, 'g^-', 'Color', [0 0.6 0] , 'LineWidth', 1.2); hold on;
semilogy(snr, mse_qpsk_mmse, 'gs-', 'Color', [0 0.6 0], 'LineWidth', 1.2);
semilogy(snr, mse_16qam_ls, 'b^-', 'Color', [0 0.4 1], 'LineWidth', 1.2);
semilogy(snr, mse_16qam_mmse, 'bs-', 'Color', [0 0.4 1], 'LineWidth', 1.2);
semilogy(snr, mse_64qam_ls, 'r^-', 'Color', [1 0 0], 'LineWidth', 1.2);
semilogy(snr, mse_64qam_mmse, 'rs-', 'Color', [1 0 0], 'LineWidth', 1.2);
xlabel('SNR (dB)'); ylabel('MSE'); grid on;
legend('QPSK - LS/ZF', 'QPSK - MMSE', ...
       '16QAM - LS/ZF', '16QAM - MMSE', ...
       '64QAM - LS/ZF', '64QAM - MMSE');
title('MSE vs. SNR');
